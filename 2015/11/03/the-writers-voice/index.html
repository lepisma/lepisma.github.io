<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-08-14 Sun 11:16 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Writers' Voice</title>
<meta name="author" content="Abhinav Tushar" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel="stylesheet" type="text/css" href="/assets/css/pace.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css" />
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,800" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono" >
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="/assets/js/pace.min.js"></script>
<script src="/assets/js/jquery.zoomooz.min.js"></script>
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/assets/favicons/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/favicons/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/favicons/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicons/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/assets/favicons/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/assets/favicons/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/assets/favicons/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicons/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-128.png" sizes="128x128" />
<meta name="application-name" content="&nbsp;" />
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="/assets/favicons/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="/assets/favicons/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="/assets/favicons/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="/assets/favicons/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="/assets/favicons/mstile-310x310.png" />
<script defer data-domain="lepisma.xyz" src="https://plausible.io/js/plausible.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">
<header>
  <div class='site-title'>
    <a href='/'>
      <img src='/assets/images/avatar32.png'>
    </a>
  </div>
  <div class='site-nav'>
    <a class='active' href='/'> blog</a>
    <a  href='/journal'> journal</a>
    <a  href='/log'> log</a>
    <a  href='/wiki'> wiki</a>
    <a href='/about'> about</a>
  </div>
  <div class='clearfix'></div>
</header>

<div class='page-header'>
  <div class='page-meta'>2015-11-03 Tue 00:00</div>
  <h1>The Writers' Voice</h1>
</div>
</div>
<div id="content" class="content">
<script src="https://d3js.org/d3.v3.min.js"></script>


<div class='page-tags'><a href='../../../..#ml'>ml</a> <a href='../../../..#exploration'>exploration</a> <a href='../../../..#viz'>viz</a></div>
<style>
#scatter, #words {
  font-size: 12px;
}

.tooltip {
  position: absolute;
  width: 200px;
  height: 28px;
  pointer-events: none;
  font-size: 12px;
}

.footer {
  bottom: -16px;
  position: relative;
}
</style>

<div class="page-intro" id="orgb342f83">
<p>
Exploring a new way to compare storytelling in classics by comparing
changing signals in a word embedding space using dynamic time warping.
</p>

</div>

<p>
<span class='dropcap'>I</span>f you are a fanatic reader of a particular author, you can immediately identify
whether a given (unknown) text is written by him/her or not. Apart from the
idiosyncrasies and diction, the flow and development of text is particularly
unique to an author. You can actually visualize a curve of rising and falling
emotional cues like <i>thrill</i>, <i>optimism</i>, <i>confusion</i> in their works. Taking these
works as signals can, in principle, allow us to compare the writing styles. This
post tries to do the same using a technique called <i>dynamic time warping</i> on
signals based on word vectors gathered from classic literary works.
</p>

<div id="outline-container-sec-text-to-signal" class="outline-2">
<h2 id="sec-text-to-signal"><span class="section-number-2">1.</span> Text to Signal</h2>
<div class="outline-text-2" id="text-sec-text-to-signal">

<p>
There are many ways to see text as a time series. I will use a pretty basic and
intuitive technique with word embeddings.
</p>
</div>

<div id="outline-container-sec-text-to-signal/word-embeddings" class="outline-3">
<h3 id="sec-text-to-signal/word-embeddings"><span class="section-number-3">1.1.</span> Word Embeddings</h3>
<div class="outline-text-3" id="text-sec-text-to-signal/word-embeddings">

<p>
Word embeddings provide projections of <i>words</i> from any language to some \(N\)
dimensional mathematical space. In simple terms, it provides a vector for each
word it has seen. The vector is learned in relation to the context in which it
appears. A popular method uses Continuous Bag of Words and Skip-gram and has a
python implementation in <a href="https://radimrehurek.com/gensim/models/word2vec.html">gensim (Word2Vec)</a>.
</p>

<p>
An excellent primer on the topic is on the blog of Christopher Olah <a href="http://colah.github.io/posts/2014-07-NLP-RNNs-Representations/">here</a>. This
vector representation does two things for us:
</p>

<ul class="org-ul">
<li><i>Gives us something much more amenable to mathematical analysis, numbers.</i></li>
<li><i>Arranges the words in vector space according to the semantic meanings.</i></li>
</ul>

<p>
A sample of 1000 words from a 100 dimensional word space (t-SNE/ed/ to 2
dimensions) after training on <a href="https://www.gutenberg.org/">Project Gutenberg's</a> 1000 ebooks is shown below.
Although the words look mostly archaic, lookout for nearby words with semantic
connections (hover on dots).
</p>

<figure> <div id='words'></div> <figcaption>
<p>
1000 words from a 100-D vector space
</p>
</figcaption></figure>
</div>
</div>

<div id="outline-container-sec-text-to-signal/cramming-text" class="outline-3">
<h3 id="sec-text-to-signal/cramming-text"><span class="section-number-3">1.2.</span> Cramming text</h3>
<div class="outline-text-3" id="text-sec-text-to-signal/cramming-text">

<p>
After training an embedding model (with 100 dimensions) and computing vectors
for each word in a book, we are left with a matrix of size \(N_w \times 100\), where
\(N_w\) is the number of words. One simple reduction strategy for \(N_w\) is to
simply take sentence vectors by averaging out the words (though, we could have
used <a href="https://radimrehurek.com/gensim/models/doc2vec.html">Doc2Vec</a> here, but let's go with this). For 100 columns, we can hinge to few
fixed word vectors like <i>romance</i>, <i>mystery</i> and calculate cosine distances of the
rows from these anchor points. But, since the word space coverage might be
severely affected, a better way is to create anchor points in the number space
directly.
</p>

<p>
A simple K-means clustering with 4 centers provide us the anchor points and now
the matrices are of size \(N_s \times 4\). Below is the graph for <i>The Sign of the Four</i>
by Arthur Conan Doyle.
</p>


<figure id="org5e0cfa5">
<img src="./anchors.png" alt="anchors.png" class="zoomTarget" data-closeclick="true">

<figcaption><span class="figure-number">Figure 1: </span>Similarities of words in <i>The Sign of the Four</i> with the 4 anchor points.</figcaption>
</figure>

<p>
The smooth lines are generated after using a gaussian filter and they more or
less capture the essence of the flow.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-comparing-signals" class="outline-2">
<h2 id="sec-comparing-signals"><span class="section-number-2">2.</span> Comparing signals</h2>
<div class="outline-text-2" id="text-sec-comparing-signals">

<p>
Once we have set of comparable signals for each book, next step is to do actual
comparison. A simple way would be to extract some sort of features from these
time series or directly apply techniques to learn from the series. But, let's
try something more crude and direct.
</p>

<blockquote>
<p>
In time series analysis, dynamic time warping (DTW) is an algorithm for
measuring similarity between two temporal sequences which may vary in time or
speed.
</p>

<footer>Wikipedia</footer>
</blockquote>

<p>
In short this is what we want. DTW has simple working principles and is
invariant of length and positions of peaks and valleys in signals. The <a href="https://en.wikipedia.org/wiki/Dynamic_time_warping#Implementation">pseudo
code</a> on Wikipedia should get you started.
</p>
</div>

<div id="outline-container-sec-comparing-signals/distances-to-coordinates" class="outline-3">
<h3 id="sec-comparing-signals/distances-to-coordinates"><span class="section-number-3">2.1.</span> Distances to coordinates</h3>
<div class="outline-text-3" id="text-sec-comparing-signals/distances-to-coordinates">

<p>
Once we get the distances, we get 2D cartesian coordinates using <a href="https://en.wikipedia.org/wiki/Multidimensional_scaling">Multi
Dimensional Scaling (MDS)</a>. Although we won't talk about this here, MDS is a cool
thing to look for in data visualization.
</p>

<p>
Anyway, here is the scatterplot of 24 classic books.
</p>

<figure> <div id='scatter'></div> <figcaption>
<p>
24 classics clustered according to similarity calculated using the DTW method
</p>
</figcaption></figure>

<p>
Jane Austen gets a personal space of her own. Mark Twain looks versatile.
</p>

<p>
One thing that personally worries me while reading fiction is the easy
predictability, not of facts (which doesn't hurt), but of what will happen next
in a global emotional context. Reading <a href="https://www.goodreads.com/book/show/6411961-the-lost-symbol">The Lost Symbol</a> made me feel like I am
reading <a href="https://www.goodreads.com/book/show/11125.Digital_Fortress">Digital Fortress</a> all again. Hopefully, this won't happen again.
</p>

<script src="./scatter.js"></script>
<script src="./words.js"></script>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer id='footer'></footer>
</div>
</body>
</html>
